name: Notify Slack on PR Merge

on:
  pull_request:
    types: opened

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: Notify Slack
        run: |
          # TODO: pass the PR title and body to the payload (with escaped markdown)
          payload='{"text": "Docs Update","channel": "C08K7SB0VT8","blocks": [{"type": "markdown","text": ":blue_book: [${{ github.event.pull_request.user.login }}](https://github.com/${{ github.event.pull_request.user.login }}) opened a new PR on the docs!"},{"type": "divider"},{"type": "markdown","text": "HELLO WORLD"}]}'
          payload=$(echo $payload | jq -c)

          curl -X POST https://slack.com/api/chat.postMessage \
            -H "Authorization: Bearer ${{ secrets.SLACK_BOT_TOKEN }}" \
            -H "Content-type: application/json; charset=utf-8" \
            -d "$payload"
