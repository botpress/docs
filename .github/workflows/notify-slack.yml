name: Notify Slack on PR Merge

on: pull_request

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: Notify Slack
        run: |
          payload='{ "channel": "C08K7SB0VT8", "text": ":blue_book: [${{ github.event.pull_request.user.login }}](https://github.com/${{ github.event.pull_request.user.login }}) updated the docs!" }'
          payload=$(echo $payload | jq -c)

          echo "### PAYLOAD ###"
          echo $payload | jq

          curl -X POST https://slack.com/api/chat.postMessage \
            -H "Authorization: Bearer ${{ secrets.SLACK_BOT_TOKEN }}" \
            -H "Content-type: application/json; charset=utf-8" \
            -d $payload
