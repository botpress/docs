---
title: Workflows
---

Workflows are long-running processes that handle complex, multi-step operations or scheduled tasks. Unlike [conversations](/for-developers/adk/concepts/conversations), workflows can run independently on a schedule or be triggered by events.

<Note>
  While workflows in the ADK are similar in concept to [Workflows](/learn/reference/workflows) in Botpress Studio, they behave differently and shouldn't be treated as equivalent.
</Note>

## Creating a workflow

Create a workflow in `src/workflows/`:

```typescript
import { Workflow } from "@botpress/runtime";

export default new Workflow({
  name: "my-workflow",
  description: "A workflow that processes data",
  handler: async ({}) => {
    // Workflow logic
  },
});
```

## Scheduled workflows

Workflows can run on a schedule using cron syntax:

```typescript highlight={6}
import { WebsiteKB } from '../knowledge/docs'

export default new Workflow({
  name: "periodic-indexing",
  description: "Indexes knowledge base every 6 hours",
  schedule: "0 */6 * * *", // Every 6 hours
  handler: async ({}) => {
    await WebsiteKB.refresh();
  },
});
```

## Workflow steps

Use the `step` function to create checkpoints in long-running workflows:

```typescript highlight={4-17}
export default new Workflow({
  name: "data-processing",
  handler: async ({ step }) => {
    // Step 1: Fetch data
    const data = await step("fetch-data", async () => {
      return await fetchDataFromAPI();
    });

    // Step 2: Process data
    const processed = await step("process-data", async () => {
      return processData(data);
    });

    // Step 3: Store results
    await step("store-results", async () => {
      await saveResults(processed);
    });
  },
});
```

Steps are persisted, so if a workflow is interrupted, it can resume from the last completed step.

## Reference

### Workflow props

<Expandable title="Workflow props">
  <ResponseField
    name="name"
    type="string"
    required
  >
    Unique name for the workflow. Used to identify and reference the workflow.
  </ResponseField>
  <ResponseField
    name="description"
    type="string"
  >
    Optional description of what the workflow does.
  </ResponseField>
  <ResponseField
    name="input"
    type="z.ZodTypeAny"
  >
    Optional Zod schema defining the input parameters for the workflow. Defaults to an empty object if not provided.
  </ResponseField>
  <ResponseField
    name="output"
    type="z.ZodTypeAny"
  >
    Optional Zod schema defining the output/return type of the workflow. Defaults to an empty object if not provided.
  </ResponseField>
  <ResponseField
    name="state"
    type="z.ZodTypeAny"
  >
    Optional Zod schema defining the workflow state structure. Defaults to an empty object if not provided.
  </ResponseField>
  <ResponseField
    name="requests"
    type="object"
  >
    Optional object mapping request names to their Zod schemas. Each key is a request name and value is a Zod schema for the request data.
  </ResponseField>
  <ResponseField
    name="handler"
    type="(props: object) => Promise&lt;any&gt; | any"
    required
  >
    Handler function that implements the workflow logic. See handler parameters below for details.
  </ResponseField>
  <ResponseField
    name="schedule"
    type="string"
  >
    Optional cron expression for scheduled workflows (e.g., "0 */6 * * *" for every 6 hours).
  </ResponseField>
  <ResponseField
    name="timeout"
    type="'{number}s' | '{number}m' | '{number}h'"
  >
    Optional timeout for workflow execution (e.g., "5m", "1h"). Defaults to "5m".
  </ResponseField>
</Expandable>

### Handler parameters

The handler function receives workflow context and provides step management:

<Expandable title="Handler parameters">
  <ResponseField
    name="input"
    type="any"
    required
  >
    The validated input object matching the workflow's input schema. Typed based on your input schema.
  </ResponseField>
  <ResponseField
    name="state"
    type="any"
    required
  >
    Workflow state object that persists across workflow executions and steps. Typed based on your state schema.
  </ResponseField>
  <ResponseField
    name="step"
    type="object"
    required
  >
    Step function for creating checkpoints. Also provides methods like `listen`, `fail`, `progress`, `abort`, `sleep`, `sleepUntil`, `waitForWorkflow`, `executeWorkflow`, `map`, `forEach`, `batch`, and `request`.
  </ResponseField>
  <ResponseField
    name="client"
    type="object"
    required
  >
    Botpress client for making API calls (tables, events, etc.).
  </ResponseField>
  <ResponseField
    name="execute"
    type="(props: object) => Promise&lt;any&gt;"
    required
  >
    Function to execute autonomous AI logic. Used to run the agent with instructions, tools, knowledge bases, etc.
    <Expandable title="Execute props">
      <ResponseField
        name="instructions"
        type="string | (() => string) | (() => Promise&lt;string&gt;)"
        required
      >
        Instructions for the AI agent. Can be a string or a function that returns a string.
      </ResponseField>
      <ResponseField
        name="tools"
        type="object[]"
      >
        Optional array of tools the agent can use.
      </ResponseField>
      <ResponseField
        name="objects"
        type="object[]"
      >
        Optional array of objects the agent can interact with.
      </ResponseField>
      <ResponseField
        name="exits"
        type="Record&lt;string, object&gt;"
      >
        Optional record of exit handlers.
      </ResponseField>
      <ResponseField
        name="signal"
        type="AbortSignal"
      >
        Optional abort signal to cancel execution.
      </ResponseField>
      <ResponseField
        name="hooks"
        type="object"
      >
        Optional hooks for customizing behavior (`onBeforeTool`, `onAfterTool`, `onTrace`, etc.).
      </ResponseField>
      <ResponseField
        name="temperature"
        type="number | (() => number) | (() => Promise&lt;number&gt;)"
      >
        Optional temperature for the AI model. Defaults to 0.7.
      </ResponseField>
      <ResponseField
        name="model"
        type="string | string[] | (() => string | string[]) | (() => Promise&lt;string | string[]&gt;)"
      >
        Optional model name(s) to use. Can be a string, array of strings, or a function that returns either.
      </ResponseField>
      <ResponseField
        name="knowledge"
        type="object[]"
      >
        Optional array of knowledge bases to use.
      </ResponseField>
      <ResponseField
        name="iterations"
        type="number"
      >
        Optional maximum number of iterations (loops). Defaults to 10.
      </ResponseField>
    </Expandable>
  </ResponseField>
</Expandable>
